--- dlls/dwrite/analyzer.c
+++ dlls/dwrite/analyzer.c
@@ -2150,30 +2150,37 @@ static HRESULT WINAPI fontfallback_MapCharacters(IDWriteFontFallback1 *iface, ID
 
     if (basefamily && *basefamily) {
         hr = create_matching_font(basecollection, basefamily, weight, style, stretch, ret_font);
-        if (FAILED(hr))
-            goto done;
 
-        hr = fallback_map_characters(*ret_font, text, length, mapped_length);
-        if (FAILED(hr))
-            goto done;
+        /* It is not a fatal error for create_matching_font to
+           fail. We still have other fallbacks to try. */
+
+        if (SUCCEEDED(hr))
+        {
+            hr = fallback_map_characters(*ret_font, text, length, mapped_length);
+            if (FAILED(hr))
+                goto done;
+        }
     }
 
     if (!*mapped_length) {
-        IDWriteFont *mapped_font;
-
-        hr = fallback_get_fallback_font(fallback, text, length, weight, style, stretch, mapped_length, &mapped_font);
-        if (FAILED(hr)) {
-            /* fallback wasn't found, keep base font if any, so we can get at least some visual output */
-            if (*ret_font) {
-                *mapped_length = length;
-                hr = S_OK;
-            }
-        }
-        else {
-            if (*ret_font)
-                IDWriteFont_Release(*ret_font);
-            *ret_font = mapped_font;
+        if (*ret_font)
+        {
+            IDWriteFont_Release(*ret_font);
+            *ret_font = NULL;
         }
+
+        hr = fallback_get_fallback_font(fallback, text, length, weight, style, stretch, mapped_length, ret_font);
+        if (FAILED(hr))
+            goto done;
+    }
+
+    if (!*mapped_length)
+    {
+        /* fallback wasn't found, ask the caller to skip one character
+           and try again; FIXME: skip the appropriate number of
+           characters instead of just one */
+        *mapped_length = 1;
+        hr = S_OK;
     }
 
 done:
