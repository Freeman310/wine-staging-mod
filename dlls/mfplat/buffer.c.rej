--- dlls/mfplat/buffer.c
+++ dlls/mfplat/buffer.c
@@ -939,8 +942,13 @@ static HRESULT WINAPI dxgi_surface_buffer_Lock(IMFMediaBuffer *iface, BYTE **dat
             hr = dxgi_surface_buffer_map(buffer);
             if (SUCCEEDED(hr))
             {
+                if (buffer->dxgi_surface.rb_texture_format == DXGI_FORMAT_NV12)
+                    lines = buffer->_2d.height * 3 / 2;
+                else
+                    lines = buffer->_2d.height;
+
                 MFCopyImage(buffer->_2d.linear_buffer, buffer->_2d.width, buffer->dxgi_surface.map_desc.pData,
-                        buffer->dxgi_surface.map_desc.RowPitch, buffer->_2d.width, buffer->_2d.height);
+                        buffer->dxgi_surface.map_desc.RowPitch, buffer->_2d.width, lines);
             }
         }
     }
@@ -974,8 +983,13 @@ static HRESULT WINAPI dxgi_surface_buffer_Unlock(IMFMediaBuffer *iface)
         hr = HRESULT_FROM_WIN32(ERROR_WAS_UNLOCKED);
     else if (!--buffer->_2d.locks)
     {
+        if (buffer->dxgi_surface.rb_texture_format == DXGI_FORMAT_NV12)
+            lines = buffer->_2d.height * 3 / 2;
+        else
+            lines = buffer->_2d.height;
+
         MFCopyImage(buffer->dxgi_surface.map_desc.pData, buffer->dxgi_surface.map_desc.RowPitch,
-                buffer->_2d.linear_buffer, buffer->_2d.width, buffer->_2d.width, buffer->_2d.height);
+                buffer->_2d.linear_buffer, buffer->_2d.width, buffer->_2d.width, lines);
         dxgi_surface_buffer_unmap(buffer);
 
         free(buffer->_2d.linear_buffer);
